# API Team - Department-Scoped Endpoints Final Response

## Date: 2026-01-20
## From: API Team
## To: UI Team
## Priority: High
## In Response To: 2026-01-18_department_scoped_endpoints.md
## Related Issues: UI-ISS-040, UI-ISS-041

---

## Decision: Use Existing Query Parameter Pattern

After review, we will continue using the **query parameter filtering pattern** which is already implemented and working. This is a valid RESTful approach and avoids duplicating endpoint logic.

---

## How to Use Existing Endpoints

### 1. Department Courses

**Use:** `GET /api/v2/courses?department={departmentId}`

**Supported Query Params:**
| Param | Type | Description |
|-------|------|-------------|
| `department` | string | **Filter by department ID** |
| `status` | string | draft, published, archived |
| `search` | string | Search title/description |
| `page` | number | Pagination (default: 1) |
| `limit` | number | Items per page (default: 10) |
| `sortBy` | string | Sort field |
| `sortOrder` | string | asc or desc |

**Example:**
```bash
GET /api/v2/courses?department=507f1f77bcf86cd799439011&status=published&page=1&limit=20
```

---

### 2. Department Classes

**Use:** `GET /api/v2/classes?department={departmentId}`

**Supported Query Params:**
| Param | Type | Description |
|-------|------|-------------|
| `department` | string | **Filter by department ID** |
| `courseId` | string | Filter by course |
| `status` | string | scheduled, active, completed, cancelled |
| `page` | number | Pagination |
| `limit` | number | Items per page |

**Example:**
```bash
GET /api/v2/classes?department=507f1f77bcf86cd799439011&status=active
```

---

### 3. Department Settings

**Get Settings:**
```bash
GET /api/v2/settings?departmentId={departmentId}
GET /api/v2/settings/{key}?departmentId={departmentId}
```

**Update Settings:**
```bash
PUT /api/v2/settings/{key}
Content-Type: application/json

{
  "value": "...",
  "departmentId": "507f1f77bcf86cd799439011"
}
```

---

### 4. Department Learners - NEW ENDPOINT REQUIRED

**Status:** Will be implemented

**Endpoint:** `GET /api/v2/users/learners?department={departmentId}`

**Planned Response:**
```json
{
  "success": true,
  "data": {
    "learners": [
      {
        "id": "user_123",
        "name": "John Doe",
        "email": "john@example.com",
        "activeEnrollments": 3,
        "overallProgress": 67.5,
        "lastActivityDate": "2026-01-19T14:30:00Z"
      }
    ],
    "pagination": {...}
  }
}
```

**Implementation Issue:** API-ISS-001 (created)

---

## Existing Nested Routes (Already Available)

For reference, these nested routes already exist:

| Endpoint | Purpose |
|----------|---------|
| `GET /api/v2/departments/:id/programs` | Programs in department |
| `GET /api/v2/departments/:id/staff` | Staff assigned to department |
| `GET /api/v2/departments/:id/stats` | Department statistics |
| `GET /api/v2/departments/:id/hierarchy` | Department tree structure |

---

## Summary

| UI Requirement | Solution | Status |
|----------------|----------|--------|
| Department courses | `GET /courses?department=xxx` | Available now |
| Department classes | `GET /classes?department=xxx` | Available now |
| Department settings | `GET/PUT /settings?departmentId=xxx` | Available now |
| Department learners | `GET /users/learners?department=xxx` | **In development** |

---

*This response was generated by the API development team*
