# API Team - Department-Scoped Endpoints Review

## Date: 2026-01-20
## From: API Team
## To: UI Team
## Priority: High
## In Response To: 2026-01-18_department_scoped_endpoints.md
## Related Issues: UI-ISS-040, UI-ISS-041

---

## Summary

We've reviewed the department-scoped endpoints request. Here's the current state:

## Existing Alternatives (Query Parameter Filtering)

**The API uses query parameter filtering instead of nested routes:**

| UI Request | Existing Alternative | Status |
|------------|---------------------|--------|
| `GET /departments/:id/courses` | `GET /api/v2/courses?department=xxx` | Works |
| `GET /departments/:id/classes` | `GET /api/v2/classes?department=xxx` | Works |
| `GET /departments/:id/learners` | No equivalent | **MISSING** |
| `GET /departments/:id/settings` | `GET /api/v2/settings?departmentId=xxx` | Works |
| `PUT /departments/:id/settings` | `PUT /api/v2/settings/:key` (body: departmentId) | Works |

---

## Existing Nested Department Routes

These DO exist:

| Endpoint | Purpose |
|----------|---------|
| `GET /api/v2/departments/:id/programs` | Programs in department |
| `GET /api/v2/departments/:id/staff` | Staff assigned to department |
| `GET /api/v2/departments/:id/stats` | Department statistics |
| `GET /api/v2/departments/:id/hierarchy` | Department tree structure |

---

## Confirmation: Existing Filters Work

### GET /api/v2/courses

Query parameter: `?department=xxx`

Supported filters:
- `department` - Filter by department ID
- `status` - draft, published, archived
- `search` - Search title/description
- `page`, `limit` - Pagination
- `sortBy`, `sortOrder` - Sorting

### GET /api/v2/classes

Query parameter: `?department=xxx`

Supported filters:
- `department` - Filter by department ID (ObjectId)
- `courseId` - Filter by course
- `status` - scheduled, active, completed, cancelled
- `page`, `limit` - Pagination

---

## Missing Functionality

### Department Learners Endpoint - NOT IMPLEMENTED

The learners endpoint with the requested data points does not exist:
- Learner basic info (id, name, email)
- Number of active enrollments in department
- Overall progress percentage
- Last activity date

**This requires new implementation.**

---

## Options for Your Consideration

### Option A: Use Existing Query Parameters
- Use `GET /api/v2/courses?department=xxx` instead of nested routes
- Use `GET /api/v2/classes?department=xxx` instead of nested routes
- Requires new endpoint for learners only

### Option B: Create All Nested Routes
- Create `/api/v2/departments/:id/courses` (new route, same logic)
- Create `/api/v2/departments/:id/classes` (new route, same logic)
- Create `/api/v2/departments/:id/learners` (new endpoint)
- Create `/api/v2/departments/:id/settings` (new routes)

---

## API Team Recommendation

**Pending internal discussion.** We will respond with:
1. Confirmed approach (Option A or B)
2. Timeline for learners endpoint
3. Any API contract updates

---

*This response was generated by the API development team. Follow-up response pending.*
