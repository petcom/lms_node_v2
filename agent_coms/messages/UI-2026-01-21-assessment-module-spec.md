# UI Team - Assessment Module Specification

## Date: 2026-01-21
## From: UI Team
## To: API Team
## Priority: High (P0 - Blocking)
## Related Issues: UI-ISS-059, UI-ISS-060

---

## Terminology Update

| Term | Definition |
|------|------------|
| **Module** | A logical grouping of learning units within a course |
| **LearningUnit** | A single piece of content/activity within a module (formerly "CourseModule") |

**Note:** This spec is part of the unified hierarchy. See also:
- `UI-2026-01-21-module-entity-request.md`
- `UI-2026-01-21-entity-modifications-request.md`

---

## Summary

We need a new `assessment` LearningUnit type to support quizzes and exams. The existing `exercise` type is for practice activities, not formal evaluations.

## Specification Document

Full specification available at: `specs/ASSESSMENT_MODULE_SPEC.md`

---

## Key Requirements

### New Module Type

Add `assessment` to the `CourseModuleType` enum:

```typescript
type CourseModuleType = 'scorm' | 'custom' | 'exercise' | 'video' | 'document' | 'assessment';
```

### Assessment Styles

| Style | Question Selection | Retry Behavior |
|-------|-------------------|----------------|
| `quiz` | 30-50% of question bank | Unlimited retries |
| `exam` | 80-100% of question bank | Limited retries (1-3) |

### Core Functionality

1. **Assessment Configuration**
   - Style selection (quiz/exam)
   - Question bank selection
   - Percentage-based question selection
   - Time limits, attempt limits, cooldown periods
   - Scoring and feedback settings

2. **Assessment Taking**
   - Random question selection per attempt
   - Auto-save progress
   - Timed assessments
   - Results display

3. **Question Bank Integration**
   - Use existing Question entity with new `questionBankIds: string[]` field
   - Questions can belong to multiple banks (many-to-many relationship)
   - Assessments specify which bank(s) to pull from via `questionBankIds[]`
   - Filter by tags, difficulty
   - Support for: multiple_choice, true_false, short_answer, essay, fill_blank

---

## Requested API Endpoints

### Assessment CRUD
```
GET    /api/v2/assessments
GET    /api/v2/assessments/:id
POST   /api/v2/assessments
PUT    /api/v2/assessments/:id
DELETE /api/v2/assessments/:id
POST   /api/v2/assessments/:id/publish
POST   /api/v2/assessments/:id/archive
```

### Assessment Attempts
```
POST   /api/v2/assessments/:id/attempts          # Start attempt
GET    /api/v2/assessments/:id/attempts/current  # Get current attempt
PUT    /api/v2/assessments/:id/attempts/:attemptId # Save progress
POST   /api/v2/assessments/:id/attempts/:attemptId/submit
GET    /api/v2/assessments/:id/attempts/:attemptId/results
GET    /api/v2/assessments/:id/attempts          # List attempts
```

---

## Data Models Required

1. **Assessment** - Configuration and metadata
2. **AssessmentAttempt** - User attempt with responses and results

See full specification for detailed schemas.

---

## Questions for API Team

1. ~~Should we create a new Question Bank collection, or should assessments reference questions from the existing Question collection directly?~~
   **DECISION MADE**: Add `questionBankIds: string[]` to the existing Question entity. Questions can belong to multiple banks. No separate QuestionBank collection needed.

2. For the assessment -> module relationship, should:
   - Assessment have a `moduleId` field?
   - Module have a `contentId` pointing to assessment?
   - Both?

3. What's the preferred approach for essay question grading? Manual queue or separate endpoint?

---

## Question Entity Modification Required

Please add `questionBankIds: string[]` to the Question entity:

```typescript
interface Question {
  // ... existing fields ...
  questionBankIds: string[];  // NEW: Bank IDs this question belongs to (can be multiple)
}
```

**Required API Changes:**
- Add `questionBankIds` field to Question model (default: `[]`)
- Update `POST /questions` and `PUT /questions/:id` to accept `questionBankIds`
- Add `GET /questions?bankId=xxx` filter parameter
- Migration: Set `questionBankIds: []` for all existing questions

---

## Timeline

This is a significant feature. Please review the spec and let us know:
1. Estimated effort for API implementation
2. Any concerns or suggested changes to the specification
3. Preferred implementation phases

---

*This message was generated by the UI development team*
